(()=>{"use strict";const e=window.wp.i18n,i=window.wp.blocks,o=window.wp.blockEditor,n=window.wp.element,l=window.wp.components,a=window.React;var t,s;function c(){return c=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var o=arguments[i];for(var n in o)({}).hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},c.apply(null,arguments)}var r=function(e){return a.createElement("svg",c({xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",viewBox:"0 0 25 26"},e),t||(t=a.createElement("path",{d:"M3.1 3.9V10H1.8V3.9zM3.3 2c0 .1 0 .2-.1.3 0 .1-.1.2-.2.3 0 .1-.1.2-.2.2s-.2.1-.3.1-.2 0-.3-.1c-.2 0-.2-.1-.3-.2-.1 0-.2-.1-.2-.2s-.1-.2-.1-.3 0-.2.1-.3c0-.1.1-.2.2-.3.1-.2.1-.2.2-.3.1 0 .2-.1.3-.1s.2 0 .3.1c.1 0 .2.1.3.2s.1.2.2.3.1.2.1.3m1.9 8V4.9l-.6-.1c-.1 0-.2-.1-.2-.1-.1 0-.2-.1-.2-.2V4h.9v-.6c0-.3 0-.7.1-.9.2-.3.4-.5.6-.7s.4-.3.7-.4c.2-.1.5-.2.9-.2h.4c.1 0 .3 0 .4.1v.6c0 .1-.1.2-.2.2h-.4c-.2 0-.3 0-.5.1-.1.1-.3.2-.4.3s-.2.2-.2.4c-.1.1-.1.3-.1.6V4h1.7v.9H6.5V10zM13.8 17.8c.6.2 1.3.4 2.1.4v-1.3c-.5 0-.9-.1-1.2-.2s-.5-.3-.7-.5l-1.1 1.1c.2.2.5.4.9.5M12.5 2.1c-.3.5-.5 1-.5 1.7v3c0 .5-.1.8-.3 1.1s-.5.5-.8.6c-.4.1-.8.2-1.3.2V10c.5 0 1 .1 1.3.2.4.1.6.3.8.6s.3.7.3 1.1v1.2h.9c.3 0 .5.1.7.2v-1.5c0-.7-.2-1.2-.5-1.6s-.9-.7-1.6-.8c.7-.1 1.2-.4 1.6-.8.3-.4.5-1 .5-1.6V4c0-.4.1-.8.3-1.1s.4-.5.8-.6c.3-.1.8-.2 1.2-.2V.7c-.8 0-1.5.1-2 .3-.7.3-1.1.6-1.4 1.1M23.1 8.6c-.4-.1-.6-.3-.8-.6q-.3-.45-.3-1.2v-3c0-.7-.2-1.3-.5-1.7-.3-.5-.7-.8-1.3-1S18.9.8 18.1.7V2c.5 0 .9.1 1.2.2s.6.3.8.6.3.6.3 1.1v3c0 .7.2 1.2.5 1.6s.9.7 1.6.8v.1c-.7.1-1.2.4-1.6.8-.3.4-.5 1-.5 1.6v3c0 .4-.1.8-.3 1.1s-.4.5-.8.6c-.3.1-.7.2-1.2.2V18c.8 0 1.5-.1 2-.4.6-.2 1-.6 1.4-1 .3-.5.5-1 .5-1.7v-3c0-.5.1-.8.3-1.1s.5-.5.8-.6c.4-.1.8-.2 1.3-.2V8.8c-.5 0-.9-.1-1.3-.2"})),a.createElement("path",{d:"m13.8 16 .1.1.1-.1c.8-.8.4-2.1-.5-2.6v1.5c.1.5.2.8.3 1.1",style:{fill:"#fff"}}),s||(s=a.createElement("path",{d:"M12.9 14.8H9.6s-.1 0-.1.1l-.2.7c0 .1 0 .2.1.2h1.3c.1 0 .1.1.1.2l-2 2.2 1 3.4c0 .1 0 .1-.1.1h-1c-.1 0-.1 0-.1-.1L8 19.8c0-.1-.2-.1-.2 0L7.4 21v.1l.4 1.5.1.1h3.3c.1 0 .1-.1.1-.1L10 18.3v-.1l3-3.2c0-.1 0-.2-.1-.2"})),a.createElement("path",{d:"M9 13H7s-.1 0-.1.1l-.3.7c0 .1 0 .2.1.2h.8c.1 0 .1.1.1.2l-2.4 6.7c0 .1-.2.1-.2 0L3.4 16c0-.1 0-.2.1-.2h.9s.1 0 .1.1l.6 1.7c0 .1.2.1.2 0l1-2.7c0-.1 0-.2-.1-.2H2.1c-.1.1-.1.2-.1.2l3.1 9c0 .1.2.1.2 0l3.8-10.8s0-.1-.1-.1",style:{fill:"#d8141c"}}))};const d=/^[v^~<>=]*?(\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+)(?:\.([x*]|\d+))?(?:-([\da-z\-]+(?:\.[\da-z\-]+)*))?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i,u=e=>{if("string"!=typeof e)throw new TypeError("Invalid argument expected string");const i=e.match(d);if(!i)throw new Error(`Invalid argument not valid semver ('${e}' received)`);return i.shift(),i},y=e=>"*"===e||"x"===e||"X"===e,p=e=>{const i=parseInt(e,10);return isNaN(i)?e:i},m=(e,i)=>{if(y(e)||y(i))return 0;const[o,n]=((e,i)=>typeof e!=typeof i?[String(e),String(i)]:[e,i])(p(e),p(i));return o>n?1:o<n?-1:0},v=(e,i)=>{for(let o=0;o<Math.max(e.length,i.length);o++){const n=m(e[o]||"0",i[o]||"0");if(0!==n)return n}return 0},f={pageType:(0,e._x)("Page Type","Condition Type Label","vk-dynamic-if-block"),postType:(0,e._x)("Post Type","Condition Type Label","vk-dynamic-if-block"),taxonomy:(0,e._x)("Taxonomy","Condition Type Label","vk-dynamic-if-block"),language:(0,e._x)("Language","Condition Type Label","vk-dynamic-if-block"),userRole:(0,e._x)("User Role","Condition Type Label","vk-dynamic-if-block"),postAuthor:(0,e._x)("Post Author","Condition Type Label","vk-dynamic-if-block"),customField:(0,e._x)("Custom Field","Condition Type Label","vk-dynamic-if-block"),period:(0,e._x)("Display Period","Condition Type Label","vk-dynamic-if-block"),loginUser:(0,e._x)("Login User Only","Condition Type Label","vk-dynamic-if-block"),mobileDevice:(0,e._x)("Mobile Device Only","Condition Type Label","vk-dynamic-if-block")},k=[{value:"none",label:(0,e.__)("No restriction","vk-dynamic-if-block")},{value:"is_front_page",label:(0,e.__)("Front Page","vk-dynamic-if-block"),func:"is_front_page()"},{value:"is_single",label:(0,e.__)("Single","vk-dynamic-if-block"),func:"is_single()"},{value:"is_page",label:(0,e.__)("Page","vk-dynamic-if-block"),func:"is_page()"},{value:"is_singular",label:(0,e.__)("Singular","vk-dynamic-if-block"),func:"is_singular()"},{value:"is_home",label:(0,e.__)("Post Top","vk-dynamic-if-block"),func:"is_home() && ! is_front_page()"},{value:"is_post_type_archive",label:(0,e.__)("Post Type Archive","vk-dynamic-if-block"),func:"is_post_type_archive() && !is_year() && !is_month() && !is_date()"},{value:"is_category",label:(0,e.__)("Category Archive","vk-dynamic-if-block"),func:"is_category()"},{value:"is_tag",label:(0,e.__)("Tag Archive","vk-dynamic-if-block"),func:"is_tag()"},{value:"is_tax",label:(0,e.__)("Taxonomy Archive","vk-dynamic-if-block"),func:"is_tax()"},{value:"is_year",label:(0,e.__)("Yearly Archive","vk-dynamic-if-block"),func:"is_year()"},{value:"is_month",label:(0,e.__)("Monthly Archive","vk-dynamic-if-block"),func:"is_month()"},{value:"is_date",label:(0,e.__)("Daily Archive","vk-dynamic-if-block"),func:"is_date()"},{value:"is_author",label:(0,e.__)("Author Archive","vk-dynamic-if-block"),func:"is_author()"},{value:"is_archive",label:(0,e.__)("Archive","vk-dynamic-if-block"),func:"is_archive()"},{value:"is_search",label:(0,e.__)("Search Result","vk-dynamic-if-block"),func:"is_search()"},{value:"is_404",label:(0,e.__)("404","vk-dynamic-if-block"),func:"is_404()"}],_=[{value:"valueExists",label:(0,e.__)("Value Exist ( !empty() )","vk-dynamic-if-block")},{value:"valueEquals",label:(0,e.__)("Value Equals ( === )","vk-dynamic-if-block")}],g=[{value:"none",label:(0,e.__)("No restriction","vk-dynamic-if-block")},{value:"deadline",label:(0,e.__)("Set to display deadline","vk-dynamic-if-block")},{value:"startline",label:(0,e.__)("Set to display startline","vk-dynamic-if-block")},{value:"daysSincePublic",label:(0,e.__)("Number of days from the date of publication","vk-dynamic-if-block")}],h=[{value:"direct",label:(0,e.__)("Direct input in this block","vk-dynamic-if-block")},{value:"referCustomField",label:(0,e.__)("Refer to value of custom field","vk-dynamic-if-block")}],b=[{value:"none",label:(0,e.__)("No restriction","vk-dynamic-if-block")},{value:"has_parent",label:(0,e.__)("Has parent page","vk-dynamic-if-block")},{value:"has_children",label:(0,e.__)("Has child pages","vk-dynamic-if-block")}],x=[{label:(0,e.__)("AND","vk-dynamic-if-block"),value:"and"},{label:(0,e.__)("OR","vk-dynamic-if-block"),value:"or"}],C={className:"vk-dynamic-if-block",defaultTemplate:[["core/paragraph",{}]],defaultConditionType:"pageType",defaultOperator:"and"},T=()=>"vkdif_"+Math.random().toString(36).substr(2,15)+"_"+Date.now().toString(36),D=(e,i)=>({id:T(),conditions:[{id:T(),type:e,values:i}],operator:C.defaultOperator}),j=()=>!(void 0!==window.wpVersion&&null!==window.wpVersion&&(e=>{const i=u(e),o=u("6.3"),n=i.pop(),l=o.pop(),a=v(i,o);return 0!==a?a:n&&l?v(n.split("."),l.split(".")):n||l?n?-1:1:0})(window.wpVersion)<0),A={from:[{type:"block",isMultiBlock:!0,blocks:["*"],__experimentalConvert(e){const o=e.map((e=>(0,i.createBlock)(e.name,e.attributes,e.innerBlocks))),n={conditions:[{id:T(),name:"Condition 1",conditions:[],operator:"and"}]};return(0,i.createBlock)("vk-blocks/dynamic-if",n,o)}}],ungroup:j()?(e,i)=>i:void 0,to:j()?void 0:[{type:"block",blocks:["*"],transform:(e,i)=>i}]},S=window.ReactJSXRuntime;(0,i.registerBlockType)("vk-blocks/dynamic-if",{apiVersion:3,title:(0,e.__)("Dynamic If","vk-dynamic-if-block"),icon:(0,S.jsx)(r,{}),transforms:A,category:"theme",attributes:{conditions:{type:"array",default:[{id:"",name:"Condition 1",conditions:[],operator:"and"}]},conditionOperator:{type:"string",default:"and"},exclusion:{type:"boolean",default:!1},ifPageType:{type:"string",default:"none"},ifPostType:{type:"string",default:"none"},ifLanguage:{type:"string",default:"none"},userRole:{type:"array",default:[]},postAuthor:{type:"number",default:0},customFieldName:{type:"string",default:""},customFieldRule:{type:"string",default:"valueExists"},customFieldValue:{type:"string",default:""},periodDisplaySetting:{type:"string",default:"none"},periodSpecificationMethod:{type:"string",default:"direct"},periodDisplayValue:{type:"string",default:""},periodReferCustomField:{type:"string",default:""},showOnlyLoginUser:{type:"boolean",default:!1}},supports:{html:!1,innerBlocks:!0},edit:function({attributes:i,setAttributes:a}){const{conditions:t,conditionOperator:s,exclusion:c}=i,r=(e,i,o)=>{const n=[...t];n[e]={...n[e],conditions:[...n[e].conditions]};const l=o(n[e].conditions[i]);n[e].conditions[i]=l,a({conditions:n})};(0,n.useEffect)((()=>{if(t&&t.length>0&&t.some((e=>!e.id||e.conditions&&e.conditions.some((e=>!e.id))))){const e=t.map((e=>({...e,id:e.id||T(),conditions:e.conditions?e.conditions.map((e=>({...e,id:e.id||T()}))):[]})));a({conditions:e})}}),[t,a]);const[d,u]=(0,n.useState)(!1),[y,p]=(0,n.useState)(!1);(0,n.useEffect)((()=>{if(d)return;if(p(!0),t&&t.length>0&&t[0]&&t[0].conditions&&Array.isArray(t[0].conditions)&&t[0].conditions.length>0)return u(!0),void p(!1);if(t&&t.length>0&&t[0]&&t[0].type&&!t[0].conditions){const e=t.filter((e=>{if(!e||!e.type)return!1;switch(e.type){case"pageType":return e.values&&e.values.ifPageType&&"none"!==e.values.ifPageType;case"postType":return e.values&&e.values.ifPostType&&"none"!==e.values.ifPostType;case"language":return e.values&&e.values.ifLanguage&&"none"!==e.values.ifLanguage;case"userRole":return e.values&&e.values.userRole&&Array.isArray(e.values.userRole)&&e.values.userRole.length>0;case"postAuthor":return e.values&&e.values.postAuthor&&0!==e.values.postAuthor;case"customField":return e.values&&e.values.customFieldName&&"none"!==e.values.customFieldName;case"period":return e.values&&e.values.periodDisplaySetting&&"none"!==e.values.periodDisplaySetting;case"loginUser":return e.values&&!0===e.values.showOnlyLoginUser;case"mobileDevice":return e.values&&!0===e.values.showOnlyMobileDevice;default:return!0}})).map((e=>({id:T(),conditions:[{...e,id:e.id||T()}],operator:"and"})));return 0===e.length&&e.push({id:T(),conditions:[{id:T(),type:"pageType",values:{ifPageType:"none"}}],operator:"and"}),a({conditions:e}),u(!0),void p(!1)}const e=["ifPageType","ifPostType","ifLanguage","userRole","postAuthor","customFieldName","customFieldRule","customFieldValue","periodDisplaySetting","periodSpecificationMethod","periodDisplayValue","periodReferCustomField","showOnlyLoginUser","showOnlyMobileDevice"];if(!e.some((e=>{const o=i[e];return"userRole"===e?Array.isArray(o)&&o.length>0:"postAuthor"===e?0!==o:"showOnlyLoginUser"===e||"showOnlyMobileDevice"===e?!0===o:"customFieldName"===e||"customFieldValue"===e||"periodDisplayValue"===e||"periodReferCustomField"===e?o&&""!==o&&"none"!==o:o&&"none"!==o&&""!==o})))return void u(!0);const o=[],n=(e=>[{attr:"ifPageType",type:"pageType",key:"ifPageType",condition:e=>e&&"none"!==e},{attr:"ifPostType",type:"postType",key:"ifPostType",condition:e=>e&&"none"!==e},{attr:"ifLanguage",type:"language",key:"ifLanguage",condition:e=>e&&"none"!==e},{attr:"userRole",type:"userRole",key:"userRole",condition:e=>e&&e.length>0},{attr:"postAuthor",type:"postAuthor",key:"postAuthor",condition:e=>e&&e>0},{attr:"customFieldName",type:"customField",key:null,condition:e=>e,customValues:()=>({customFieldName:e.customFieldName,...e.customFieldRule?{customFieldRule:e.customFieldRule}:{},...e.customFieldValue?{customFieldValue:e.customFieldValue}:{}})},{attr:"periodDisplaySetting",type:"period",key:null,condition:e=>e&&"none"!==e,customValues:()=>({periodDisplaySetting:e.periodDisplaySetting,...e.periodSpecificationMethod?{periodSpecificationMethod:e.periodSpecificationMethod}:{},...e.periodDisplayValue?{periodDisplayValue:e.periodDisplayValue}:{},...e.periodReferCustomField?{periodReferCustomField:e.periodReferCustomField}:{}})},{attr:"showOnlyLoginUser",type:"loginUser",key:"showOnlyLoginUser",condition:e=>e},{attr:"showOnlyMobileDevice",type:"mobileDevice",key:"showOnlyMobileDevice",condition:e=>e}])(i);n.forEach((e=>{const n=i[e.attr];if(e.condition(n)){const i=e.customValues?e.customValues():{[e.key]:Array.isArray(n)?n[0]||"":n};o.push(D(e.type,i))}})),0===o.length&&o.push(D("pageType",{ifPageType:"none"}));const l={conditions:o};e.forEach((e=>{let i="none";"userRole"===e?i=[]:"postAuthor"===e?i=0:"showOnlyLoginUser"===e?i=!1:"customFieldRule"===e?i="valueExists":"periodSpecificationMethod"===e&&(i="direct"),l[e]=i})),["customFieldName","customFieldValue","periodDisplayValue","periodReferCustomField","showOnlyMobileDevice"].forEach((e=>{let i="none";"showOnlyMobileDevice"===e&&(i=!1),l[e]=i})),a(l),u(!0),p(!1)}),[d]),(0,n.useEffect)((()=>{if(d&&t&&t.length>0&&t[0]&&t[0].conditions.length>0){const e=["ifPageType","ifPostType","ifLanguage","userRole","postAuthor","customFieldName","customFieldRule","customFieldValue","periodDisplaySetting","periodSpecificationMethod","periodDisplayValue","periodReferCustomField","showOnlyLoginUser","showOnlyMobileDevice"];if(e.some((e=>{const o=i[e];return"userRole"===e?Array.isArray(o)&&o.length>0:"postAuthor"===e?0!==o:"showOnlyLoginUser"===e?!0===o:o&&"none"!==o&&""!==o}))){const i={};e.forEach((e=>{let o="none";"userRole"===e?o=[]:"postAuthor"===e?o=0:"showOnlyLoginUser"===e?o=!1:"customFieldRule"===e?o="valueExists":"periodSpecificationMethod"===e&&(o="direct"),i[e]=o})),a(i)}}}),[d,t]);const m=Object.entries(f).map((([e,i])=>({value:e,label:i}))),v=k.map((e=>({value:e.value,label:e.func?`${e.label} ( ${e.func} )`:e.label,simpleLabel:e.label}))),j=(0,n.useMemo)((()=>{try{return Object.entries(vkDynamicIfBlockLocalizeData?.userRoles||{}).map((([e,i])=>({value:e,label:i})))}catch(e){return[]}}),[]),A=(0,n.useMemo)((()=>vkDynamicIfBlockLocalizeData?.userSelectOptions||[]),[]),w=(i={},o=0,n=0)=>{const{type:a="",values:s={}}=i,c=(e,i)=>((e,i,o,n)=>{!Array.isArray(t)||e<0||i<0||r(e,i,(e=>({...e,values:{...e.values,[o]:n}})))})(o,n,e,i),d=()=>(0,S.jsx)(l.SelectControl,{label:(0,e.__)("Page Hierarchy","vk-dynamic-if-block"),value:s.pageHierarchyType||"none",options:b,onChange:e=>c("pageHierarchyType",e)}),u={pageType:()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(l.SelectControl,{label:(0,e.__)("Page Type","vk-dynamic-if-block"),value:s.ifPageType||"none",options:v,onChange:e=>c("ifPageType",e)}),"is_page"===s.ifPageType&&d()]}),postType:()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(l.SelectControl,{label:(0,e.__)("Post Type","vk-dynamic-if-block"),value:s.ifPostType||"none",options:vkDynamicIfBlockLocalizeData?.postTypeSelectOptions||[],onChange:e=>c("ifPostType",e)}),"page"===s.ifPostType&&d()]}),language:()=>{const i=((e=[],i="")=>[...e].sort(((e,o)=>""===e.value?-1:""===o.value?1:e.value===i?-1:o.value===i?1:"en_US"===e.value?-1:"en_US"===o.value?1:e.label.localeCompare(o.label))))(vkDynamicIfBlockLocalizeData?.languageSelectOptions||[],vkDynamicIfBlockLocalizeData?.currentSiteLanguage||"");return(0,S.jsx)(l.SelectControl,{label:(0,e._x)("Language","Select a language","vk-dynamic-if-block"),value:s.ifLanguage||"",options:i,onChange:e=>c("ifLanguage",e)})},userRole:()=>{try{if(!s)return(0,S.jsx)(l.BaseControl,{__nextHasNoMarginBottom:!0,className:"dynamic-if-user-role",children:(0,S.jsx)("p",{children:(0,e.__)("No values available","vk-dynamic-if-block")})});const i=Array.isArray(j)?j:[];let o=[];return Array.isArray(s.userRole)?o=s.userRole:s.userRole&&(o=[s.userRole]),0===i.length?(0,S.jsx)(l.BaseControl,{__nextHasNoMarginBottom:!0,className:"dynamic-if-user-role",children:(0,S.jsx)("p",{children:(0,e.__)("No user roles available","vk-dynamic-if-block")})}):(0,S.jsx)(l.BaseControl,{__nextHasNoMarginBottom:!0,className:"dynamic-if-user-role",children:i.map(((e,i)=>e&&e.value?e.value&&"string"==typeof e.value?(0,S.jsx)(l.CheckboxControl,{__nextHasNoMarginBottom:!0,label:e.label||"",checked:o.includes(e.value),onChange:i=>{const n=i?[...o,e.value]:o.filter((i=>i!==e.value));c("userRole",n)}},e.value||i):(0,S.jsx)("div",{},`invalid-${i}`):(0,S.jsx)("div",{},`empty-${i}`)))})}catch(i){return(0,S.jsx)(l.BaseControl,{__nextHasNoMarginBottom:!0,className:"dynamic-if-user-role",children:(0,S.jsx)("p",{children:(0,e.__)("Error loading user roles","vk-dynamic-if-block")})})}},postAuthor:()=>(0,S.jsx)(l.SelectControl,{label:(0,e.__)("Post Author","vk-dynamic-if-block"),value:s.postAuthor||0,options:A,onChange:e=>c("postAuthor",parseInt(e)||0)}),customField:()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(l.TextControl,{label:(0,e.__)("Custom Field Name","vk-dynamic-if-block"),value:s.customFieldName||"",onChange:e=>c("customFieldName",e)}),s.customFieldName&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(l.SelectControl,{label:(0,e.__)("Custom Field Rule","vk-dynamic-if-block"),value:s.customFieldRule||"",options:_,onChange:e=>c("customFieldRule",e)}),"valueEquals"===s.customFieldRule&&(0,S.jsx)(l.TextControl,{label:(0,e.__)("Custom Field Value","vk-dynamic-if-block"),value:s.customFieldValue||"",onChange:e=>c("customFieldValue",e)})]})]}),period:()=>(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(l.SelectControl,{label:(0,e.__)("Display Period Setting","vk-dynamic-if-block"),value:s.periodDisplaySetting||"none",options:g,onChange:e=>c("periodDisplaySetting",e)}),s.periodDisplaySetting&&"none"!==s.periodDisplaySetting&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(l.SelectControl,{label:(0,e.__)("Period specification method","vk-dynamic-if-block"),value:s.periodSpecificationMethod||"direct",options:h,onChange:e=>c("periodSpecificationMethod",e)}),"direct"===s.periodSpecificationMethod&&(0,S.jsx)(l.TextControl,{label:(0,e.__)("Value for the specified period","vk-dynamic-if-block"),type:"daysSincePublic"===s.periodDisplaySetting?"number":"datetime-local",step:"daysSincePublic"===s.periodDisplaySetting?1:60,value:s.periodDisplayValue||"",onChange:e=>c("periodDisplayValue",e)}),"referCustomField"===s.periodSpecificationMethod&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(l.TextControl,{label:(0,e.__)("Referenced custom field name","vk-dynamic-if-block"),value:s.periodReferCustomField||"",onChange:e=>c("periodReferCustomField",e)}),!s.periodReferCustomField&&(0,S.jsx)("div",{className:"vkdif__alert vkdif__alert-warning",children:(0,e.__)("Enter the name of the custom field you wish to reference.","vk-dynamic-if-block")})]})]})]}),loginUser:()=>(0,S.jsx)(l.ToggleControl,{label:(0,e.__)("Displayed only for logged-in users.","vk-dynamic-if-block"),checked:s.showOnlyLoginUser||!1,onChange:e=>c("showOnlyLoginUser",e)}),taxonomy:()=>{const i=vkDynamicIfBlockLocalizeData?.taxonomySelectOptions||[],a=vkDynamicIfBlockLocalizeData?.termSelectOptions||{},t=s.taxonomy||"none",d=t&&"none"!==t&&a[t]||[],u=Array.isArray(s.termIds)?s.termIds:[];return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(l.SelectControl,{label:(0,e.__)("Taxonomy","vk-dynamic-if-block"),value:t,options:[{value:"none",label:(0,e.__)("No restriction","vk-dynamic-if-block")},...i],onChange:e=>{r(o,n,(i=>({...i,values:{...i.values,taxonomy:e,termIds:[]}})))}}),t&&"none"!==t&&(0,S.jsx)(l.SelectControl,{label:(0,e.__)("Select Term","vk-dynamic-if-block"),value:u[0]||"",options:[{value:"",label:(0,e.__)("No restriction","vk-dynamic-if-block")},...d],onChange:e=>{c("termIds",e?[e]:[])}})]})},mobileDevice:()=>(0,S.jsx)(l.ToggleControl,{label:(0,e.__)("Displayed only on mobile devices.","vk-dynamic-if-block"),checked:s.showOnlyMobileDevice||!1,onChange:e=>c("showOnlyMobileDevice",e)})};return u[a]?.()||null},F=(e={},i=[],o="",n=!1)=>{const l=e[o];if(!l||!Array.isArray(i))return null;const a=i.find((e=>e?.value===l));return a?.[n?"simpleLabel":"label"]||l},N=(0,n.useMemo)((()=>{try{if(!Array.isArray(t)||!t.length)return c?`${(0,e.__)("!","vk-dynamic-if-block")} ${(0,e.__)("No conditions set","vk-dynamic-if-block")}`:(0,e.__)("No conditions set","vk-dynamic-if-block");const i=t.filter((e=>e&&e.conditions&&Array.isArray(e.conditions))).map((i=>{const{conditions:o=[]}=i||{};if(!o.length)return null;const n=o[0];if(!n?.type)return null;const{values:l={}}=n,a={pageType:()=>{const e=F(l,v,"ifPageType",!0),i="is_page"===l.ifPageType&&l.pageHierarchyType&&"none"!==l.pageHierarchyType?F(l,b,"pageHierarchyType"):null;return i?`${e} (${i})`:e},postType:()=>{const e=F(l,vkDynamicIfBlockLocalizeData?.postTypeSelectOptions||[],"ifPostType"),i="page"===l.ifPostType&&l.pageHierarchyType&&"none"!==l.pageHierarchyType?F(l,b,"pageHierarchyType"):null;return i?`${e} (${i})`:e},language:()=>F(l,vkDynamicIfBlockLocalizeData?.languageSelectOptions||[],"ifLanguage"),userRole:()=>{try{const i=l.userRole||[];let o=[];if(Array.isArray(i)?o=i:i&&(o=[i]),!o.length)return(0,e.__)("No user roles selected","vk-dynamic-if-block");let n=[];return Array.isArray(j)&&(n=j),o.map((e=>{if(!e)return"";const i=n.find((i=>i.value===e));return i?.label||e})).filter(Boolean).join(", ")||(0,e.__)("Unknown user roles","vk-dynamic-if-block")}catch(i){return(0,e.__)("Error generating user role label","vk-dynamic-if-block")}},postAuthor:()=>F(l,A,"postAuthor"),customField:()=>l.customFieldName||null,period:()=>l.periodDisplaySetting&&"none"!==l.periodDisplaySetting?l.periodDisplaySetting:null,loginUser:()=>l.showOnlyLoginUser?(0,e.__)("Login User Only","vk-dynamic-if-block"):null,taxonomy:()=>{try{const i=l.taxonomy,o=l.termIds||[];if(!i||"none"===i)return null;const n=vkDynamicIfBlockLocalizeData?.taxonomySelectOptions||[],a=vkDynamicIfBlockLocalizeData?.termSelectOptions||{},t=n.find((e=>e.value===i))?.label||i,s=a[i]||[],c=o.map((e=>{const i=s.find((i=>i.value===parseInt(e)));return i?.label||""})).filter(Boolean).join(", ");return c?`${t}: ${c}`:`${t} (${(0,e.__)("No terms selected","vk-dynamic-if-block")})`}catch(i){return(0,e.__)("Error generating taxonomy label","vk-dynamic-if-block")}},showOnlyMobileDevice:()=>l.showOnlyMobileDevice?(0,e.__)("Mobile Device Only","vk-dynamic-if-block"):null};return a[n.type]?.()||n.type||null})).filter(Boolean);if(!i.length)return c?`${(0,e.__)("!","vk-dynamic-if-block")} ${(0,e.__)("No conditions set","vk-dynamic-if-block")}`:(0,e.__)("No conditions set","vk-dynamic-if-block");const o=i.join(` ${s?.toUpperCase()||"AND"} `);return c?`${(0,e.__)("!","vk-dynamic-if-block")} ${o}`:o}catch(i){return(0,e.__)("Error generating labels","vk-dynamic-if-block")}}),[t,s,c,v,j,A]);return(0,S.jsxs)("div",{...(0,o.useBlockProps)({className:C.className}),children:[(0,S.jsx)(o.InspectorControls,{children:(0,S.jsx)(l.PanelBody,{title:(0,e.__)("Display Conditions","vk-dynamic-if-block"),className:"vkdif",children:y?(0,S.jsx)("div",{children:(0,S.jsx)("p",{children:(0,e.__)("Migrating block structureâ€¦","vk-dynamic-if-block")})}):t&&Array.isArray(t)&&0===t.length?(0,S.jsxs)("div",{children:[(0,S.jsxs)(l.BaseControl,{__nextHasNoMarginBottom:!0,className:"dynamic-if-add-condition",children:[(0,S.jsx)("p",{children:(0,e.__)("No conditions set. Add a condition to control display.","vk-dynamic-if-block")}),(0,S.jsx)(l.Button,{variant:"primary",onClick:()=>{const e={id:T(),type:C.defaultConditionType,values:{}};if(0===t.length)a({conditions:[{id:T(),conditions:[e],operator:C.defaultOperator}]});else{const i=[...t];i[0]={...i[0],conditions:[...i[0].conditions,e]},a({conditions:i})}},children:(0,e.__)("Add Condition","vk-dynamic-if-block")})]}),(0,S.jsx)(l.ToggleControl,{label:(0,e.__)("Exclusion designation","vk-dynamic-if-block"),checked:c,onChange:e=>a({exclusion:e})})]}):(0,S.jsxs)(S.Fragment,{children:[t&&Array.isArray(t)&&t.map(((i,o)=>(0,S.jsxs)("div",{className:"vkdif__group",children:[(0,S.jsx)("div",{className:"vkdif__group-conditions",children:i.conditions&&Array.isArray(i.conditions)&&i.conditions.map(((i,n)=>{const a=m;return(0,S.jsxs)("div",{className:"vkdif__condition",children:[(0,S.jsx)("div",{className:"vkdif__condition-header",children:(0,S.jsx)(l.SelectControl,{label:(0,e.__)("Condition Type","vk-dynamic-if-block"),value:i.type,options:a,onChange:e=>((e,i,o)=>{!Array.isArray(t)||e<0||i<0||!o||r(e,i,(e=>{let i=e.values;return o.type&&o.type!==e.type&&(i="pageType"===o.type?{ifPageType:"none"}:"postType"===o.type?{ifPostType:"none"}:"userRole"===o.type?{userRole:[]}:"language"===o.type?{ifLanguage:""}:"postAuthor"===o.type?{postAuthor:0}:"taxonomy"===o.type?{taxonomy:"none",termIds:[]}:{}),{...e,...o,values:i}}))})(o,n,{type:e,values:{}})})}),(0,S.jsx)("div",{className:"vkdif__condition-settings",children:w(i,o,n)})]},i.id)}))}),(0,S.jsx)(l.Button,{variant:"secondary",isDestructive:!0,onClick:()=>{const e=[...t];e.splice(o,1),a({conditions:e})},children:(0,e.__)("Remove Condition","vk-dynamic-if-block")})]},i.id))),(0,S.jsx)(l.BaseControl,{__nextHasNoMarginBottom:!0,className:"dynamic-if-add-condition",children:(0,S.jsx)(l.Button,{variant:"secondary",onClick:()=>{const e={id:T(),conditions:[{id:T(),type:C.defaultConditionType,values:{}}],operator:"or"},i=[...t,e];a({conditions:i})},className:"vkdif__add-condition",children:(0,e.__)("Add Condition","vk-dynamic-if-block")})}),t&&Array.isArray(t)&&t.length>1&&(0,S.jsx)(l.SelectControl,{label:(0,e.__)("Condition Operator","vk-dynamic-if-block"),value:s,options:x,onChange:e=>a({conditionOperator:e})}),(0,S.jsx)(l.ToggleControl,{label:(0,e.__)("Exclusion designation","vk-dynamic-if-block"),checked:c,onChange:e=>a({exclusion:e})}),(0,S.jsx)("div",{class:"alert alert-info",children:(0,e.__)("By placing a Dynamic If -Else block inside a Dynamic If block, you can specify the elements to display if the conditions are not met.","vk-dynamic-if-block")})]})})}),(0,S.jsx)("div",{className:"vk-dynamic-if-block__label",children:(0,S.jsx)("span",{children:N||(0,e.__)("No conditions set","vk-dynamic-if-block")})}),(0,S.jsx)(o.InnerBlocks,{template:C.defaultTemplate})]})},save:()=>(0,S.jsx)(o.InnerBlocks.Content,{})}),(0,i.registerBlockType)("vk-blocks/dynamic-if-else",{apiVersion:3,title:(0,e.__)("Dynamic If - Else","vk-dynamic-if-block"),icon:(0,S.jsx)(r,{}),category:"theme",parent:["vk-blocks/dynamic-if"],attributes:{},supports:{html:!1,innerBlocks:!0},edit:function(){return(0,S.jsxs)("div",{...(0,o.useBlockProps)({className:"vk-dynamic-if-else-block"}),children:[(0,S.jsx)("div",{className:"vk-dynamic-if-else-block__label",children:(0,S.jsx)("span",{children:(0,e.__)("When conditions are not met","vk-dynamic-if-block")})}),(0,S.jsx)("div",{className:"vk-dynamic-if-else-block__content",children:(0,S.jsx)(o.InnerBlocks,{template:[["core/paragraph",{}]],renderAppender:()=>null})})]})},save:()=>(0,S.jsxs)("div",{className:"vk-dynamic-if-else-block",children:[(0,S.jsx)("div",{className:"vk-dynamic-if-else-block__label",children:(0,S.jsx)("span",{children:"Else"})}),(0,S.jsx)("div",{className:"vk-dynamic-if-else-block__content",children:(0,S.jsx)(o.InnerBlocks.Content,{})})]})})})();